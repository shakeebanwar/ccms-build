"use strict";(self.webpackChunkccms=self.webpackChunkccms||[]).push([[4590],{24590:(e,t,a)=>{a.r(t),a.d(t,{default:()=>z});var r=a(9950),l=a(13564),n=a(26689),s=a(79537),i=a(75165),o=a(48089),c=a(68367),d=a(84142),h=a(12257),u=a(6368),p=a(82053),g=a(74745),m=a(1320),f=a(15769),x=a(34075),b=a(91434),w=a(16497),j=a(37324),A=a(40033),v=a(28170),S=a(29031),y=a(20131),O=a(90260),C=a(46765),P=a(86608),D=a(38861),R=a(8279),_=a(22704),k=a(66075),T=a(44185),E=a(63358),F=a(72870),I=a(93455),L=a(32741),B=a(95074),N=a(44414);const V=["new","old"],W=[{id:"status",label:"Order Status",align:"left",width:500},{id:"updated_at",label:"Date",align:"left",width:600},{id:"file_no",label:"File No",align:"left",width:800},{id:"property_type",label:"Property Type",align:"left",width:800},{id:"transaction_type",label:"Transection Type",align:"left",width:500},{id:"purchase_price",label:"Purchase Price",align:"left",width:800},{id:"employee",label:"Assign Employee",align:"left",width:1e3},{id:"status_change",label:"Change Status",align:"left",width:800},{id:""}],q=[{api:"titleInsurance",label:"Title Insurance"},{api:"corpLienSearch",label:"Coop Lien Searches"},{api:"acricetax",label:"ACRIS E-Tax Forms"},{api:"eaglepolicy",label:"Eagle 9 Policy"},{api:"uccform",label:"UCC"},{api:"othersearch",label:"Other Search / Request"},{api:"offeringPlan",label:"Offering Plans"},{api:"exchanger",label:"1031 Exchanges"},{api:"",label:"Sightline\xae"}];function z(){const{themeStretch:e}=(0,P.A)(),{enqueueSnackbar:t}=(0,S.dh)(),a=(0,l.Zp)(),{dense:z,page:M,order:U,orderBy:Y,rowsPerPage:H,setPage:Z,selected:G,onSort:J,onChangeDense:K,onChangePage:Q,onChangeRowsPerPage:X}=(0,D.Ay)({defaultOrderBy:"createDate"}),[$,ee]=(0,r.useState)([]),[te,ae]=(0,r.useState)(""),[re,le]=(0,r.useState)("new"),[ne,se]=(0,r.useState)(null),[ie,oe]=(0,r.useState)(null),{currentTab:ce,onChangeTab:de}=(0,C.A)("all"),[he,ue]=(0,r.useState)("Title Insurance"),[pe,ge]=(0,r.useState)(!1),[me,fe]=(0,r.useState)(!1),[xe,be]=(0,r.useState)([]),[we,je]=(0,r.useState)([]);(0,r.useEffect)((()=>{"Sightline\xae"!==he&&"UCC"!==he&&Ae(q.find((e=>e.label===he)).api)}),[he]);const Ae=e=>{ge(!0);try{L.A.get("admin/".concat(e)).then((e=>{ge(!1);const a=e.data;200===e.status?ee(a.orders):t(a.message)}))}catch(a){if(ge(!1),a.errors){Object.keys(a.errors).map((e=>t(a.errors[e][0],{variant:"error"})))}}},ve=function(e){let{tableData:t,comparator:a,filterName:r,filterStatus:l,filterService:n,filterStartDate:s,filterEndDate:i}=e;const o=t.map(((e,t)=>[e,t]));o.sort(((e,t)=>{const r=a(e[0],t[0]);return 0!==r?r:e[1]-t[1]})),t=o.map((e=>e[0])),r&&(t=t.filter((e=>-1!==e.order_title.transaction_type.toLowerCase().indexOf(r.toLowerCase())||-1!==e.order_title.property_type.toLowerCase().indexOf(r.toLowerCase()))));"all"!==l&&(t=t.filter((e=>e.status===l)));"new"!==n&&(t=t.filter((e=>e.status===n)));s&&i&&(t=t.filter((e=>e.updated_at.getTime()>=s.getTime()&&e.updated_at.getTime()<=i.getTime())));return t}({tableData:$,comparator:(0,D.hz)(U,Y),filterName:te,filterService:re,filterStatus:ce,filterStartDate:ne,filterEndDate:ie}),Se=z?56:76,ye=!ve.length&&!!te||!ve.length&&!!ce||!ve.length&&!!re||!ve.length&&!!ie||!ve.length&&!!ne,Oe=e=>$.filter((t=>t.status===e)).length,Ce=[{value:"all",label:"All",color:"info",count:$.length},{value:"active",label:"Active",color:"info",count:Oe("active")},{value:"new",label:"New",color:"info",count:Oe("new")},{value:"placed",label:"Placed",color:"info",count:Oe("placed")},{value:"completed",label:"Completed",color:"success",count:Oe("completed")},{value:"on hold",label:"On Hold",color:"warning",count:Oe("on hold")},{value:"draft",label:"Draft",color:"default",count:Oe("draft")},{value:"cancelled",label:"Cancelled",color:"error",count:Oe("cancelled")}];return(0,N.jsxs)(R.A,{title:"Order: Your Orders",children:[pe&&(0,N.jsx)(B.A,{}),(0,N.jsxs)(s.A,{maxWidth:!e&&"lg",children:[(0,N.jsx)(E.A,{heading:"Your Orders",links:[{name:"Dashboard",href:O.RO.root},{name:"Orders"}],action:(0,N.jsx)(i.A,{variant:"contained",component:n.N_,to:O.RO.legalForm,startIcon:(0,N.jsx)(k.A,{icon:"clarity:form-line"}),children:"Legal Forms"})}),(0,N.jsx)(o.A,{sx:{mb:5},children:(0,N.jsx)(c.A,{allowScrollButtonsMobile:!0,variant:"scrollable",scrollButtons:"auto",value:he,onChange:(e,t)=>ue(t),sx:{px:2,bgcolor:"background.neutral"},children:q.map((e=>(0,N.jsx)(d.A,{disableRipple:!0,value:e.label,label:(0,N.jsx)(h.A,{spacing:1,direction:"row",alignItems:"center",children:(0,N.jsx)("div",{children:e.label})})},e.label)))})}),(0,N.jsx)(u.A,{sx:{p:2},children:(0,N.jsx)(p.A,{variant:"h4",gutterBottom:!0,children:he.label})}),(0,N.jsxs)(o.A,{children:[(0,N.jsx)(c.A,{allowScrollButtonsMobile:!0,variant:"scrollable",scrollButtons:"auto",value:ce,onChange:de,sx:{px:2,bgcolor:"background.neutral"},children:Ce.map((e=>(0,N.jsx)(d.A,{disableRipple:!0,value:e.value,label:(0,N.jsxs)(h.A,{spacing:1,direction:"row",alignItems:"center",children:[(0,N.jsx)("div",{children:e.label})," ",(0,N.jsxs)(_.A,{color:e.color,children:[" ",e.count," "]})]})},e.value)))}),(0,N.jsx)(g.A,{}),(0,N.jsx)(I.F,{filterName:te,filterService:re,filterStartDate:ne,filterEndDate:ie,onFilterName:e=>{ae(e),Z(0)},onFilterService:e=>{le(e.target.value)},onFilterStartDate:e=>{se(e)},onFilterEndDate:e=>{oe(e)},optionsService:V}),(0,N.jsx)(T.A,{children:(0,N.jsx)(m.A,{sx:{minWidth:800,position:"relative"},children:(0,N.jsxs)(f.A,{size:z?"small":"medium",children:[(0,N.jsx)(F.er,{order:U,orderBy:Y,headLabel:W,rowCount:$.length,numSelected:G.length,onSort:J}),(0,N.jsxs)(x.A,{children:[ve.slice(M*H,M*H+H).map((e=>(0,N.jsx)(I.o,{row:e,onViewRow:()=>(e=>{"Title Insurance"===he&&a(O.RO.viewOrders.titleInsuranceOrderView,{state:e}),"Coop Lien Searches"===he&&a(O.RO.viewOrders.CoopLienSearchOrderView,{state:e}),"Eagle 9 Policy"===he&&a(O.RO.viewOrders.eagle9PolicyOrderView,{state:e}),"Coop/Condo offering plans"===he&&a(O.RO.viewOrders.coopCondoOfferinPlansOrderView,{state:e}),"1031 Exchanges"===he&&a(O.RO.viewOrders.exchange1031OrderView,{state:e}),"Other Search / Request"===he&&a(O.RO.viewOrders.otherSearchesOrderView,{state:e})})(e),onAssign:()=>(async e=>{if(je(e),!xe.length>0){ge(!0);try{await L.A.get("/admin/employees").then((e=>{ge(!1);const t=e.data;be(t.user)}))}catch(a){ge(!1),a.errors&&Object.keys(a.errors).map((e=>t(a.errors[e][0],{variant:"error"})))}}fe(!0)})(e.id),onStatusChange:a=>((e,a)=>{ge(!0);try{const r=new FormData;r.append("status",a),r.append("id",e),L.A.post("/admin/changeorderStatus",r).then((r=>{if(ge(!1),200===r.status||201===r.status){const l=r.data,n=$.map((t=>t.id===e?{...t,status:a}:t));ee(n),t(l.message)}}))}catch(r){ge(!1),r.errors&&Object.keys(r.errors).map((e=>t(r.errors[e][0],{variant:"error"})))}})(e.id,a)},e.id))),(0,N.jsx)(F.dO,{height:Se,emptyRows:(0,D.xl)(M,H,$.length)}),(0,N.jsx)(F.Sm,{isNotFound:ye})]})]})})}),(0,N.jsxs)(u.A,{sx:{position:"relative"},children:[(0,N.jsx)(b.A,{rowsPerPageOptions:[5,10,25],component:"div",count:ve.length,rowsPerPage:H,page:M,onPageChange:Q,onRowsPerPageChange:X}),(0,N.jsx)(w.A,{control:(0,N.jsx)(j.A,{checked:z,onChange:K}),label:"Dense",sx:{px:3,py:1.5,top:0,position:{md:"absolute"}}})]})]}),(0,N.jsxs)(y.ys,{fullWidth:!0,maxWidth:"sm",open:me,onClose:()=>{fe(!1)},children:[(0,N.jsx)(A.A,{children:"Employees"}),(0,N.jsxs)(v.A,{sx:{pb:3,mt:2,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[xe.map(((e,a)=>(0,N.jsxs)(h.A,{flexDirection:"row",alignItems:"center",justifyContent:"space-between",children:[(0,N.jsxs)(p.A,{variant:"subtitle1",children:[(0,N.jsx)(k.A,{icon:"raphael:employee"})," ",e.first_name]}),(0,N.jsx)(i.A,{variant:"text",onClick:()=>(async e=>{ge(!0);try{const a=new FormData;a.append("user_id",e.id),a.append("order_id",we),await L.A.post("/admin/assignOrder",a).then((a=>{if(ge(!1),200===a.status||201===a.status){const r=a.data,l=$.map((t=>t.id===we?{...t,employee:[e]}:t));ee(l),t(r.message)}}))}catch(a){ge(!1),a.errors&&Object.keys(a.errors).map((e=>t(a.errors[e][0],{variant:"error"})))}fe(!1)})(e),children:"Assign"})]},a))),(0,N.jsx)(h.A,{flexDirection:"row",justifyContent:"end",gap:1,children:(0,N.jsx)(i.A,{variant:"outlined",color:"inherit",onClick:()=>{fe(!1)},children:"Close"})})]})]})]})]})}}}]);