"use strict";(self.webpackChunkccms=self.webpackChunkccms||[]).push([[7964],{97964:function(e,t,r){r.r(t),r.d(t,{default:function(){return Y}});var n=r(1413),a=r(15861),l=r(29439),i=r(87757),o=r.n(i),s=r(47313),c=r(97890),u=r(29466),d=r(43265),f=r(69099),p=r(73428),h=r(5297),g=r(65280),m=r(35898),x=r(57829),b=r(61113),v=r(19536),Z=r(51629),w=r(66835),j=r(57861),S=r(91034),C=r(83929),y=r(70024),O=r(33604),D=r(96467),P=r(58908),k=r(57597),_=r(48175),T=r(80648),E=r(11338),F=r(66429),I=r(71361),L=r(86853),B=r(12025),R=r(62677),N=r(67871),V=r(55844),A=r(27657),W=r(85077),q=r(72563),U=r(46417),K=["new","old"],M=[{id:"status",label:"Order Status",align:"left",width:500},{id:"updated_at",label:"Date",align:"left",width:600},{id:"file_no",label:"File No",align:"left",width:800},{id:"property_type",label:"Property Type",align:"left",width:800},{id:"transaction_type",label:"Transection Type",align:"left",width:500},{id:"purchase_price",label:"Purchase Price",align:"left",width:800},{id:"employee",label:"Assign Employee",align:"left",width:1e3},{id:"status_change",label:"Change Status",align:"left",width:800},{id:""}],Q=[{api:"titleInsurance",label:"Title Insurance"},{api:"corpLienSearch",label:"Coop Lien Searches"},{api:"acricetax",label:"ACRIS E-Tax Forms"},{api:"eaglepolicy",label:"Eagle 9 Policy"},{api:"uccform",label:"UCC"},{api:"othersearch",label:"Other Search / Request"},{api:"offeringPlan",label:"Offering Plans"},{api:"exchanger",label:"1031 Exchanges"},{api:"",label:"Sightline\xae"}];function Y(){var e=(0,E.Z)().themeStretch,t=(0,P.Ds)().enqueueSnackbar,r=(0,c.s0)(),i=(0,F.ZP)({defaultOrderBy:"createDate"}),Y=i.dense,z=i.page,H=i.order,$=i.orderBy,G=i.rowsPerPage,J=i.setPage,X=i.selected,ee=i.onSort,te=i.onChangeDense,re=i.onChangePage,ne=i.onChangeRowsPerPage,ae=(0,s.useState)([]),le=(0,l.Z)(ae,2),ie=le[0],oe=le[1],se=(0,s.useState)(""),ce=(0,l.Z)(se,2),ue=ce[0],de=ce[1],fe=(0,s.useState)("new"),pe=(0,l.Z)(fe,2),he=pe[0],ge=pe[1],me=(0,s.useState)(null),xe=(0,l.Z)(me,2),be=xe[0],ve=xe[1],Ze=(0,s.useState)(null),we=(0,l.Z)(Ze,2),je=we[0],Se=we[1],Ce=(0,T.Z)("all"),ye=Ce.currentTab,Oe=Ce.onChangeTab,De=(0,s.useState)("Title Insurance"),Pe=(0,l.Z)(De,2),ke=Pe[0],_e=Pe[1],Te=(0,s.useState)(!1),Ee=(0,l.Z)(Te,2),Fe=Ee[0],Ie=Ee[1],Le=(0,s.useState)(!1),Be=(0,l.Z)(Le,2),Re=Be[0],Ne=Be[1],Ve=(0,s.useState)([]),Ae=(0,l.Z)(Ve,2),We=Ae[0],qe=Ae[1],Ue=(0,s.useState)([]),Ke=(0,l.Z)(Ue,2),Me=Ke[0],Qe=Ke[1];(0,s.useEffect)((function(){"Sightline\xae"!==ke&&"UCC"!==ke&&Ye(Q.find((function(e){return e.label===ke})).api)}),[ke]);var Ye=function(e){Ie(!0);try{W.Z.get("admin/".concat(e)).then((function(e){Ie(!1);var r=e.data;200===e.status?oe(r.orders):t(r.message)}))}catch(r){if(Ie(!1),r.errors)Object.keys(r.errors).map((function(e){return t(r.errors[e][0],{variant:"error"})}))}},ze=function(e){var t=e.tableData,r=e.comparator,n=e.filterName,a=e.filterStatus,l=e.filterService,i=e.filterStartDate,o=e.filterEndDate,s=t.map((function(e,t){return[e,t]}));s.sort((function(e,t){var n=r(e[0],t[0]);return 0!==n?n:e[1]-t[1]})),t=s.map((function(e){return e[0]})),n&&(t=t.filter((function(e){return-1!==e.order_title.transaction_type.toLowerCase().indexOf(n.toLowerCase())||-1!==e.order_title.property_type.toLowerCase().indexOf(n.toLowerCase())})));"all"!==a&&(t=t.filter((function(e){return e.status===a})));"new"!==l&&(t=t.filter((function(e){return e.status===l})));i&&o&&(t=t.filter((function(e){return e.updated_at.getTime()>=i.getTime()&&e.updated_at.getTime()<=o.getTime()})));return t}({tableData:ie,comparator:(0,F.sQ)(H,$),filterName:ue,filterService:he,filterStatus:ye,filterStartDate:be,filterEndDate:je}),He=Y?56:76,$e=!ze.length&&!!ue||!ze.length&&!!ye||!ze.length&&!!he||!ze.length&&!!je||!ze.length&&!!be,Ge=function(e){return ie.filter((function(t){return t.status===e})).length},Je=[{value:"all",label:"All",color:"info",count:ie.length},{value:"active",label:"Active",color:"info",count:Ge("active")},{value:"new",label:"New",color:"info",count:Ge("new")},{value:"placed",label:"Placed",color:"info",count:Ge("placed")},{value:"completed",label:"Completed",color:"success",count:Ge("completed")},{value:"on hold",label:"On Hold",color:"warning",count:Ge("on hold")},{value:"draft",label:"Draft",color:"default",count:Ge("draft")},{value:"cancelled",label:"Cancelled",color:"error",count:Ge("cancelled")}],Xe=function(){var e=(0,a.Z)(o().mark((function e(r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Qe(r),!(!We.length>0)){e.next=12;break}return Ie(!0),e.prev=3,e.next=6,W.Z.get("/admin/employees").then((function(e){Ie(!1);var t=e.data;qe(t.user)}));case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(3),Ie(!1),e.t0.errors&&Object.keys(e.t0.errors).map((function(r){return t(e.t0.errors[r][0],{variant:"error"})}));case 12:Ne(!0);case 13:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(t){return e.apply(this,arguments)}}(),et=function(){var e=(0,a.Z)(o().mark((function e(r){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ie(!0),e.prev=1,(a=new FormData).append("user_id",r.id),a.append("order_id",Me),e.next=7,W.Z.post("/admin/assignOrder",a).then((function(e){if(Ie(!1),200===e.status||201===e.status){var a=e.data,l=ie.map((function(e){return e.id===Me?(0,n.Z)((0,n.Z)({},e),{},{employee:[r]}):e}));oe(l),t(a.message)}}));case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),Ie(!1),e.t0.errors&&Object.keys(e.t0.errors).map((function(r){return t(e.t0.errors[r][0],{variant:"error"})}));case 13:Ne(!1);case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return(0,U.jsxs)(I.Z,{title:"Order: Your Orders",children:[Fe&&(0,U.jsx)(q.Z,{}),(0,U.jsxs)(d.Z,{maxWidth:!e&&"lg",children:[(0,U.jsx)(N.Z,{heading:"Your Orders",links:[{name:"Dashboard",href:_.mD.root},{name:"Orders"}],action:(0,U.jsx)(f.Z,{variant:"contained",component:u.rU,to:_.mD.legalForm,startIcon:(0,U.jsx)(B.Z,{icon:"clarity:form-line"}),children:"Legal Forms"})}),(0,U.jsx)(p.Z,{sx:{mb:5},children:(0,U.jsx)(h.Z,{allowScrollButtonsMobile:!0,variant:"scrollable",scrollButtons:"auto",value:ke,onChange:function(e,t){return _e(t)},sx:{px:2,bgcolor:"background.neutral"},children:Q.map((function(e){return(0,U.jsx)(g.Z,{disableRipple:!0,value:e.label,label:(0,U.jsx)(m.Z,{spacing:1,direction:"row",alignItems:"center",children:(0,U.jsx)("div",{children:e.label})})},e.label)}))})}),(0,U.jsx)(x.Z,{sx:{p:2},children:(0,U.jsx)(b.Z,{variant:"h4",gutterBottom:!0,children:ke.label})}),(0,U.jsxs)(p.Z,{children:[(0,U.jsx)(h.Z,{allowScrollButtonsMobile:!0,variant:"scrollable",scrollButtons:"auto",value:ye,onChange:Oe,sx:{px:2,bgcolor:"background.neutral"},children:Je.map((function(e){return(0,U.jsx)(g.Z,{disableRipple:!0,value:e.value,label:(0,U.jsxs)(m.Z,{spacing:1,direction:"row",alignItems:"center",children:[(0,U.jsx)("div",{children:e.label})," ",(0,U.jsxs)(L.Z,{color:e.color,children:[" ",e.count," "]})]})},e.value)}))}),(0,U.jsx)(v.Z,{}),(0,U.jsx)(A.o,{filterName:ue,filterService:he,filterStartDate:be,filterEndDate:je,onFilterName:function(e){de(e),J(0)},onFilterService:function(e){ge(e.target.value)},onFilterStartDate:function(e){ve(e)},onFilterEndDate:function(e){Se(e)},optionsService:K}),(0,U.jsx)(R.Z,{children:(0,U.jsx)(Z.Z,{sx:{minWidth:800,position:"relative"},children:(0,U.jsxs)(w.Z,{size:Y?"small":"medium",children:[(0,U.jsx)(V.K,{order:H,orderBy:$,headLabel:M,rowCount:ie.length,numSelected:X.length,onSort:ee}),(0,U.jsxs)(j.Z,{children:[ze.slice(z*G,z*G+G).map((function(e){return(0,U.jsx)(A.B,{row:e,onViewRow:function(){return function(e){"Title Insurance"===ke&&r(_.mD.viewOrders.titleInsuranceOrderView,{state:e}),"Coop Lien Searches"===ke&&r(_.mD.viewOrders.CoopLienSearchOrderView,{state:e}),"Eagle 9 Policy"===ke&&r(_.mD.viewOrders.eagle9PolicyOrderView,{state:e}),"Coop/Condo offering plans"===ke&&r(_.mD.viewOrders.coopCondoOfferinPlansOrderView,{state:e}),"1031 Exchanges"===ke&&r(_.mD.viewOrders.exchange1031OrderView,{state:e}),"Other Search / Request"===ke&&r(_.mD.viewOrders.otherSearchesOrderView,{state:e})}(e)},onAssign:function(){return Xe(e.id)},onStatusChange:function(r){return function(e,r){Ie(!0);try{var a=new FormData;a.append("status",r),a.append("id",e),W.Z.post("/admin/changeorderStatus",a).then((function(a){if(Ie(!1),200===a.status||201===a.status){var l=a.data,i=ie.map((function(t){return t.id===e?(0,n.Z)((0,n.Z)({},t),{},{status:r}):t}));oe(i),t(l.message)}}))}catch(l){Ie(!1),l.errors&&Object.keys(l.errors).map((function(e){return t(l.errors[e][0],{variant:"error"})}))}}(e.id,r)}},e.id)})),(0,U.jsx)(V.$W,{height:He,emptyRows:(0,F.fQ)(z,G,ie.length)}),(0,U.jsx)(V.et,{isNotFound:$e})]})]})})}),(0,U.jsxs)(x.Z,{sx:{position:"relative"},children:[(0,U.jsx)(S.Z,{rowsPerPageOptions:[5,10,25],component:"div",count:ze.length,rowsPerPage:G,page:z,onPageChange:re,onRowsPerPageChange:ne}),(0,U.jsx)(C.Z,{control:(0,U.jsx)(y.Z,{checked:Y,onChange:te}),label:"Dense",sx:{px:3,py:1.5,top:0,position:{md:"absolute"}}})]})]}),(0,U.jsxs)(k.Kl,{fullWidth:!0,maxWidth:"sm",open:Re,onClose:function(){Ne(!1)},children:[(0,U.jsx)(O.Z,{children:"Employees"}),(0,U.jsxs)(D.Z,{sx:{pb:3,mt:2,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[We.map((function(e,t){return(0,U.jsxs)(m.Z,{flexDirection:"row",alignItems:"center",justifyContent:"space-between",children:[(0,U.jsxs)(b.Z,{variant:"subtitle1",children:[(0,U.jsx)(B.Z,{icon:"raphael:employee"})," ",e.first_name]}),(0,U.jsx)(f.Z,{variant:"text",onClick:function(){return et(e)},children:"Assign"})]},t)})),(0,U.jsx)(m.Z,{flexDirection:"row",justifyContent:"end",gap:1,children:(0,U.jsx)(f.Z,{variant:"outlined",color:"inherit",onClick:function(){Ne(!1)},children:"Close"})})]})]})]})]})}}}]);