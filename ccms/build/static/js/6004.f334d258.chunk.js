"use strict";(self.webpackChunkccms=self.webpackChunkccms||[]).push([[6004],{96004:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Z});var o=n(90706),r=n(79947),i=n(28339),l=n(6978),s=n(60820),a=n(36404),d=n(9950),c=n(14857),u=n(79537),p=n(6368),m=n(75165),x=n(48089),v=n(40033),h=n(42686),f=n(62740),A=n(34117),g=n(90260),j=n(98091),b=n(86608),y=n(63358),C=n(20131),_=n(66075),w=n(13564),S=n(60666),D=n(23334),k=n.n(D),I=n(43974),M=n(29031),E=n(9449),T=n(68654),R=n(12257),F=n(41205),O=n(8145),N=n(23266),q=n(79739),H=n(53065),W=n(25333),P=n(21410),V=n(28095),z=n(91745),Y=n(52401),L=n(32741),G=n(10608),U=n(33507),B=n(44414);const X=["#00AB55","#1890FF","#54D62C","#FFC107","#FF4842","#04297A","#7A0C2E"],J=[{api:"titleInsurance",label:"Title Insurance",permission:"title_insurance"},{api:"corpLienSearch",label:"Coop Lien Searches",permission:"coop_lien_search"},{api:"acricetax",label:"ACRIS E-Tax Forms",permission:"acris_e_tax_form"},{api:"eaglepolicy",label:"Eagle 9 Policy",permission:"eagle_nine_policy"},{api:"uccform",label:"UCC",permission:"ucc"},{api:"othersearch",label:"Other Search / Request",permission:"other_search_request"},{api:"offeringPlan",label:"Offering Plans",permission:"offering_plan"},{api:"exchanger",label:"1031 Exchanges",permission:"exchanges"},{api:"",label:"Sightline\xae",permission:"sightline"}];function Q(e){let{event:t,range:n,onCancel:o,getDate:r}=e;console.log(t,"event");const{enqueueSnackbar:i}=(0,M.dh)(),l=(0,A.wA)(),{user:s}=(0,U.A)();console.log(s,"user");const a=(null===s||void 0===s?void 0:s.user_permissions)||{},c=J.find((e=>!0===(null===a||void 0===a?void 0:a[e.permission])));console.log(c,"filteredTabs");const{pathname:u}=(0,w.zy)(),{selectedFileNumber:x}=(0,A.d4)((e=>e.calendar)),[v,f]=(0,d.useState)([]),[g,j]=(0,d.useState)({}),b=0===Object.keys(t).length,y=u.includes("employee"),C=S.Ik().shape({title:S.Yj().max(255).required("Title is required"),description:S.Yj().max(5e3),order_no:S.Yj().max(5e3).required("File is Required")}),D=(0,E.mN)({resolver:(0,T.t)(C),defaultValues:((e,t)=>{var n;const o={address:(null===e||void 0===e?void 0:e.address)||"",name:e.name||"",title:"",order_no:(null===e||void 0===e||null===(n=e.orders)||void 0===n?void 0:n.order_no)||"",description:"",textColor:"#1890FF",start:t?new Date(t.start):new Date,end:r?new Date(r):new Date};return e||t?k()({},o,e):o})(t,n)}),{reset:Q,watch:$,control:K,setValue:Z,handleSubmit:ee,formState:{isSubmitting:te,errors:ne}}=D,oe=$();console.log("values",oe),(0,d.useEffect)((()=>{x&&Z("title",x),re()}),[x]);const re=()=>{try{L.A.get("employee/".concat(null===c||void 0===c?void 0:c.api)).then((e=>{const t=e.data;if(console.log(t,"Data"),200===e.status){if(f(t.orders),x){var n,o,r;const e=null===t||void 0===t||null===(n=t.orders)||void 0===n?void 0:n.find((e=>(null===e||void 0===e?void 0:e.file_no)===x));Z("name",null===(o=e.files)||void 0===o?void 0:o.file_name),Z("address",(null===(r=e.subject_premise)||void 0===r?void 0:r.property_location)||""),Z("order_no",e.order_no||"")}}else i(t.message)}))}catch(e){if(e.errors){Object.keys(e.errors).map((t=>i(e.errors[t][0],{variant:"error"})))}}};return(0,B.jsxs)(Y.Op,{methods:D,onSubmit:ee((async e=>{try{const n=!t.id&&{order_id:v.find((t=>(null===t||void 0===t?void 0:t.order_no)===e.order_no)).id,title:e.title,address:e.address,description:e.description,textColor:e.textColor,end:(0,I.A)(e.end,"yyyy-MM-dd HH:mm:ss")},r=t.id&&{status:e.status,end:(0,I.A)(e.end,"yyyy-MM-dd HH:mm:ss")};t.id?(l((0,h.wL)(t.id,r)),setTimeout((()=>{i("Update success!")}),2e3)):(console.log(n,"newEvent"),l((0,h.NB)(n)),setTimeout((()=>{i("Create success!")}),2e3)),o(),Q()}catch(n){console.error(n)}})),children:[(0,B.jsxs)(R.A,{spacing:3,sx:{p:3},children:[(0,B.jsx)(Y.o3,{name:"title",label:"title"}),(0,B.jsx)(E.xI,{name:"name",control:K,render:e=>{let{field:t}=e;return(0,B.jsx)(F.A,{value:t.value||"",options:v.map((e=>{var t;return{label:(null===e||void 0===e||null===(t=e.files)||void 0===t?void 0:t.file_name)||"",id:null===e||void 0===e?void 0:e.id}})),onChange:(e,n)=>{t.onChange((null===n||void 0===n?void 0:n.label)||"");const o=v.find((e=>{var t;return(null===e||void 0===e||null===(t=e.files)||void 0===t?void 0:t.file_name)===(null===n||void 0===n?void 0:n.label)}));o&&(Z("order_no",null===o||void 0===o?void 0:o.order_no),Z("address",o.subject_premise.property_location))},renderInput:e=>(0,B.jsx)(O.A,{...e,label:"Name",placeholder:"Search Name"})})}}),(0,B.jsx)(E.xI,{name:"address",control:K,render:e=>{let{field:t}=e;return(0,B.jsx)(F.A,{value:t.value||"",options:v.map((e=>{var t;return{label:(null===e||void 0===e||null===(t=e.subject_premise)||void 0===t?void 0:t.property_location)||"",id:e.id}})),onChange:(e,n)=>{t.onChange(n.label||null);const o=v.find((e=>e.subject_premise.property_location===(null===n||void 0===n?void 0:n.label)));o&&(Z("order_no",null===o||void 0===o?void 0:o.order_no),Z("name",null===o||void 0===o?void 0:o.files.file_name))},renderInput:e=>(0,B.jsx)(O.A,{...e,label:"Address",placeholder:"Search Address"})})}}),(0,B.jsx)(E.xI,{name:"order_no",control:K,render:e=>{let{field:t}=e;return(0,B.jsx)(F.A,{value:t.value||"",freeSolo:!0,options:v.map((e=>({label:null===e||void 0===e?void 0:e.order_no,id:null===e||void 0===e?void 0:e.order_no}))),getOptionLabel:e=>"string"===typeof e?e:e.label||"",onChange:(e,n)=>{t.onChange(n.label||null);const o=v.find((e=>(null===e||void 0===e?void 0:e.order_no)===(null===n||void 0===n?void 0:n.id)));o&&(Z("address",o.subject_premise.property_location),Z("name",null===o||void 0===o?void 0:o.files.file_name))},renderInput:e=>(0,B.jsx)(O.A,{label:"Order NO",...e})})}}),(0,B.jsx)(Y.o3,{name:"description",label:"Description",multiline:!0,rows:4}),y&&(0,B.jsx)(E.xI,{name:"status",control:K,render:e=>{let{field:t}=e;return(0,B.jsx)(O.A,{...t,fullWidth:!0,select:!0,label:"Status",SelectProps:{MenuProps:{sx:{"& .MuiPaper-root":{maxHeight:260}}}},sx:{textTransform:"capitalize"},children:G.XQ.map((e=>(0,B.jsx)(N.A,{value:e,sx:{mx:1,my:.5,borderRadius:.75,typography:"body2",textTransform:"capitalize"},children:e},e)))})}}),(0,B.jsx)(E.xI,{name:"end",control:K,render:e=>{let{field:t}=e;return(0,B.jsx)(P.A,{...t,label:"Date",inputFormat:"dd/MM/yyyy hh:mm a",renderInput:e=>(0,B.jsx)(O.A,{...e,fullWidth:!0,value:r})})}}),!y&&(0,B.jsx)(E.xI,{name:"textColor",control:K,render:e=>{let{field:t}=e;return(0,B.jsx)(z.yR,{value:t.value,onChange:t.onChange,colors:X})}})]}),(0,B.jsxs)(q.A,{children:[!b&&(0,B.jsx)(H.A,{title:"Delete Event",children:(0,B.jsx)(W.A,{onClick:async()=>{if(t.id)try{o(),l((0,h.SX)(t.id)),i("Delete success!")}catch(e){console.error(e)}},children:(0,B.jsx)(_.A,{icon:"eva:trash-2-outline",width:20,height:20})})}),(0,B.jsx)(p.A,{sx:{flexGrow:1}}),(0,B.jsx)(m.A,{variant:"outlined",color:"inherit",onClick:o,children:"Cancel"}),(0,B.jsx)(V.A,{sx:{bgcolor:"#00ab55","&:hover":{bgcolor:"#0aaa57"}},type:"submit",variant:"contained",loading:te,children:b?"Add":"Update"})]})]})}function $(e){let{event:t,range:n,onCancel:o,getDate:r}=e;const{enqueueSnackbar:i}=(0,M.dh)(),l=(0,A.wA)(),s=S.Ik().shape({title:S.Yj().max(255).required("Title is required"),description:S.Yj().max(5e3)}),a=(0,E.mN)({resolver:(0,T.t)(s),defaultValues:((e,t)=>{const n={title:"",order_id:e.order_id||"",description:"",textColor:"#1890FF",start:t?new Date(t.start):new Date,end:t?new Date(t.end):new Date,date:r?new Date(r):new Date};return e||t?k()({},n,e):n})(t,n)}),{reset:d,control:c,setValue:u,handleSubmit:p,formState:{isSubmitting:x}}=a;return(0,B.jsxs)(Y.Op,{methods:a,onSubmit:p((async e=>{try{const t={title:e.title,note:e.description,start:(0,I.A)(e.start,"HH:mm:ss"),end:(0,I.A)(e.end,"HH:mm:ss"),date:(0,I.A)(e.date,"yyyy-MM-dd HH:mm:ss")},n=await L.A.post("todo",t);console.log(n,"reminder"),l((0,h.Wb)()),o(),d()}catch(t){console.error(t)}})),children:[(0,B.jsxs)(R.A,{spacing:3,sx:{p:3},children:[(0,B.jsx)(Y.o3,{name:"title",label:"title"}),(0,B.jsx)(Y.o3,{name:"description",label:"Description",multiline:!0,rows:4}),(0,B.jsx)(E.xI,{name:"date",control:c,render:e=>{let{field:t}=e;return(0,B.jsx)(P.A,{...t,label:"Date",inputFormat:"dd/MM/yyyy",renderInput:e=>(0,B.jsx)(O.A,{...e,fullWidth:!0,value:r})})}}),(0,B.jsx)(E.xI,{name:"start",control:c,render:e=>{let{field:t}=e;return(0,B.jsx)(P.A,{...t,label:"Start Time",ampm:!0,inputFormat:"hh:mm a",renderInput:e=>(0,B.jsx)(O.A,{...e,fullWidth:!0})})}}),(0,B.jsx)(E.xI,{name:"end",control:c,render:e=>{let{field:t}=e;return(0,B.jsx)(P.A,{...t,label:"End Time",ampm:!0,inputFormat:"hh:mm a",renderInput:e=>(0,B.jsx)(O.A,{...e,fullWidth:!0,value:r})})}})]}),(0,B.jsxs)(q.A,{children:[(0,B.jsx)(m.A,{variant:"outlined",color:"inherit",onClick:o,children:"Cancel"}),(0,B.jsx)(V.A,{sx:{bgcolor:"#00ab55","&:hover":{bgcolor:"#0aaa57"}},type:"submit",variant:"contained",loading:x,children:"Add"})]})]})}const K=e=>{const{events:t,selectedEventId:n}=e.calendar;return n?t.find((e=>Number(e.id)===Number(n))):null};function Z(){const{themeStretch:e}=(0,b.A)(),t=((0,c.A)(),(0,A.wA)()),n=(0,j.A)("up","sm"),w=(0,d.useRef)(null),[S,D]=(0,d.useState)(new Date),[k,I]=(0,d.useState)(n?"dayGridMonth":"listWeek"),[M,E]=(0,d.useState)(),[T,R]=(0,d.useState)([]),[F,O]=(0,d.useState)([]),N=(0,A.d4)(K),{events:q,isOpenModal:H,selectedRange:W,isOpenReminderModal:P}=(0,A.d4)((e=>e.calendar));(0,d.useEffect)((()=>{t((0,h.Wb)())}),[t]);(0,d.useEffect)((()=>{(async()=>{try{var e;const t=await L.A.get("todos"),n=(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.todos)||[];R(n),console.log(t,"reminder")}catch(t){console.log(t,"error")}})()}),[q]),(0,d.useEffect)((()=>{const e=q.map((e=>({id:e.id,title:e.title,start:e.start,end:e.end,textColor:e.textColor||"#000",description:e.description}))),t=T.map((e=>({type:"reminder",id:e.id,title:e.note||e.title,start:new Date(e.date).toISOString().split("T")[0]+"T"+e.start,end:new Date(e.date).toISOString().split("T")[0]+"T"+e.end,textColor:e.textColor||"#000",description:e.note})));O([...e,...t])}),[q,T]),console.log(F,"mergedTasks"),(0,d.useEffect)((()=>{const e=w.current;if(e){const t=e.getApi(),o=n?"dayGridMonth":"listWeek";t.changeView(o),I(o)}}),[n]);const V=()=>{t((0,h.Oo)())},z=()=>{t((0,h.yJ)())};return(0,B.jsxs)(u.A,{maxWidth:!e&&"xl",children:[(0,B.jsx)(p.A,{sx:{display:"flex",justifyContent:"flex-end",bgcolor:"#2E3C56",p:1},children:(0,B.jsxs)(p.A,{children:[(0,B.jsx)(m.A,{variant:"contained",startIcon:(0,B.jsx)(_.A,{icon:"eva:plus-fill",width:10,height:10}),onClick:()=>{t((0,h.qf)())},sx:{fontSize:"12px",mr:2,backgroundColor:"#2E3C56","&:hover":{backgroundColor:"#2E3C56"}},children:"Order Contin"}),(0,B.jsx)(m.A,{variant:"contained",startIcon:(0,B.jsx)(_.A,{icon:"eva:plus-fill",width:10,height:10}),onClick:()=>{t((0,h.kd)())},sx:{fontSize:"12px",backgroundColor:"#2E3C56","&:hover":{backgroundColor:"#2E3C56",color:"#fff"}},children:"Add Reminder"})]})}),(0,B.jsx)(y.A,{sx:{paddingTop:"10px",paddingLeft:"20px"},links:[{name:"Dashboard",href:g.i8.root},{name:"Calender"}]}),(0,B.jsx)(x.A,{children:(0,B.jsxs)(f.mg,{children:[(0,B.jsx)(f.a7,{date:S,view:k,onNextDate:()=>{const e=w.current;if(e){const t=e.getApi();t.next(),D(t.getDate())}},onPrevDate:()=>{const e=w.current;if(e){const t=e.getApi();t.prev(),D(t.getDate())}},onToday:()=>{const e=w.current;if(e){const t=e.getApi();t.today(),D(t.getDate())}},onChangeView:e=>{const t=w.current;if(t){t.getApi().changeView(e),I(e)}}}),(0,B.jsx)(o.Ay$,{weekends:!0,editable:!0,droppable:!0,selectable:!0,events:F,ref:w,rerenderDelay:10,initialDate:S,initialView:k,dayMaxEventRows:3,eventDisplay:"block",headerToolbar:!1,allDayMaintainDuration:!0,eventResizableFromStart:!0,eventClick:e=>{t((0,h.PY)(e.event.id)),E(e.dateStr)},height:n?720:"auto",plugins:[r.A,i.Ay,s.Ay,l.Ay,a.Ay]})]})}),(0,B.jsxs)(C.ys,{open:H,onClose:V,children:[(0,B.jsx)(v.A,{children:N?"Edit Order Contin":"Add Order Contin"}),(0,B.jsx)(Q,{event:N||{},range:W,onCancel:V})]}),(0,B.jsxs)(C.ys,{open:P,onClose:z,children:[(0,B.jsx)(v.A,{children:N?"Edit Reminder":"Add Reminder"}),(0,B.jsx)($,{event:N||{},range:W,onCancel:z,getDate:M})]})]})}},48089:(e,t,n)=>{n.d(t,{A:()=>h});var o=n(58168),r=n(98587),i=n(9950),l=n(2803),s=n(5747),a=n(7951),d=n(79859),c=n(70693),u=n(37665);function p(e){return(0,u.A)("MuiCard",e)}(0,n(44245).A)("MuiCard",["root"]);var m=n(44414);const x=["className","raised"],v=(0,a.Ay)(c.A,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({overflow:"hidden"}))),h=i.forwardRef((function(e,t){const n=(0,d.A)({props:e,name:"MuiCard"}),{className:i,raised:a=!1}=n,c=(0,r.A)(n,x),u=(0,o.A)({},n,{raised:a}),h=(e=>{const{classes:t}=e;return(0,s.A)({root:["root"]},p,t)})(u);return(0,m.jsx)(v,(0,o.A)({className:(0,l.A)(h.root,i),elevation:a?8:void 0,ref:t,ownerState:u},c))}))},40033:(e,t,n)=>{n.d(t,{A:()=>h});var o=n(58168),r=n(98587),i=n(9950),l=n(2803),s=n(5747),a=n(82053),d=n(7951),c=n(79859),u=n(23025),p=n(5536),m=n(44414);const x=["className","id"],v=(0,d.Ay)(a.A,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:"16px 24px",flex:"0 0 auto"}),h=i.forwardRef((function(e,t){const n=(0,c.A)({props:e,name:"MuiDialogTitle"}),{className:a,id:d}=n,h=(0,r.A)(n,x),f=n,A=(e=>{const{classes:t}=e;return(0,s.A)({root:["root"]},u.t,t)})(f),{titleId:g=d}=i.useContext(p.A);return(0,m.jsx)(v,(0,o.A)({component:"h2",className:(0,l.A)(A.root,a),ownerState:f,ref:t,variant:"h6",id:g},h))}))}}]);